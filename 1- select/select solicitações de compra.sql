SELECT DISTINCT A.DATAINCLUSAO AS DATA_INCLUSAO_SOL_PAI,
EMP.NOME AS NOME_EMPRESA,
FIL.NOME AS NOME_FILIAL,

CASE WHEN A.STATUS = 1 THEN 'CADASTRADA' ELSE
   CASE WHEN A.STATUS = 2 THEN 'CONFIRMADA' ELSE
       CASE WHEN A.STATUS = 3 THEN 'EM ATENDIMENTO' ELSE
          CASE WHEN A.STATUS = 4 THEN 'ENCERRADA' ELSE
             CASE WHEN A.STATUS = 5 THEN 'RECUSADA' ELSE
                CASE WHEN A.STATUS = 6 THEN 'CANCELADA' ELSE 'ATENDIMENTO DIVERGENTE'
                END
             END
          END
       END
   END
END AS STATUS_SOL_PAI,

CASE WHEN SOL_ITENS.STATUS = 1 THEN 'CADASTRADA' ELSE
   CASE WHEN SOL_ITENS.STATUS = 2 THEN 'ATENDIMENTO DIVERGENTE' ELSE
       CASE WHEN SOL_ITENS.STATUS = 3 THEN 'EM ATENDIMENTO' ELSE
          CASE WHEN SOL_ITENS.STATUS = 4 THEN 'ENCERRADA' ELSE
             CASE WHEN SOL_ITENS.STATUS = 5 THEN 'CANCELADA'
             END
          END
       END
   END
END AS STATUS_SOL_FILHO,

CASE WHEN A.MODALIDADE = 'R' THEN 'REGULARIZAÇÃO' ELSE
    CASE WHEN A.MODALIDADE = 'C' THEN 'CATALOGO' ELSE 'NORMAL' END
END AS MODALIDADE,
A.NUMERO AS NUM_SOL_PAI,
SOL_ITENS.NUMERO AS NUM_SOL_FILHO,
OCS.NUMERO AS ORDEM_DE_COMPRA,
UPPER(SOL.APELIDO) AS NOME_DO_SOLICITANTE,
UPPER(SOL.EMAIL) AS EMAIL_DO_SOLICITANTE,

CASE WHEN UPPER(SOL_APROVA.APELIDO) IS NOT NULL THEN UPPER(SOL_APROVA.APELIDO) ELSE
UPPER(APR.APELIDO) END AS NOME_DO_APROVADOR,
CASE WHEN UPPER(SOL_APROVA.EMAIL) IS NOT NULL THEN UPPER(SOL_APROVA.EMAIL) ELSE
UPPER(APR.EMAIL) END AS EMAIL_DO_APROVADOR,

REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(A.MOTIVOSTATUS ,char(13),''),char(9),''),char(10),''),'/N','/ N'),'/R','/ R') AS MOTIVO_STATUS,

SOL_ITENS.QUANTIDADE AS QUANTIDADE_SOLICITADA,
SOL_ITENS.VALORESTIMADO AS VALOR_DO_ITEM,
RA.CODIGO AS CENTRO_DE_CUSTO,
CASE WHEN SOL_ITENS.PROJETO IS NULL THEN 'OPEX' ELSE
'CAPEX' END AS PROJETO,
CONCAT(FIN.ESTRUTURA," - ",FIN.CODIGO) AS FINALIDADE_ESTRUTURA,
FIN.DESCRICAO AS FINALIDADE_DESCRICAO,


REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(A.OBSERVACOES ,char(13),''),char(9),''),char(10),''),'/N','/ N'),'/R','/ R') AS TEXTO_OBSERVACOES,
REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(AC.NOME ,char(13),''),char(9),''),char(10),''),'/N','/ N'),'/R','/ R') AS NOME_ITEM,
EA.NOME AS UNIDADE_DE_MEDIDA

FROM CP_SOLICITACOES A
LEFT JOIN EMPRESAS EMP ON EMP.HANDLE = A.EMPRESA
LEFT JOIN FILIAIS FIL ON FIL.HANDLE = A.FILIAL
LEFT JOIN Z_GRUPOUSUARIOS SOL ON SOL.HANDLE = A.SOLICITANTE
LEFT JOIN Z_GRUPOUSUARIOS APR ON APR.HANDLE = A.USUARIOALTERACAO
LEFT JOIN CP_SOLICITACAOITENS SOL_ITENS ON SOL_ITENS.SOLICITACAO = A.HANDLE
LEFT JOIN PD_PRODUTOS AC ON AC.HANDLE = SOL_ITENS.PRODUTO
INNER JOIN CM_UNIDADESMEDIDA EA ON  EA.HANDLE = AC.UNIDADEMEDIDACOMPRAS
LEFT JOIN CP_FINALIDADES FIN ON FIN.HANDLE = SOL_ITENS.FINALIDADE
LEFT JOIN CT_CC RA ON RA.HANDLE = SOL_ITENS.CENTROCUSTO
LEFT JOIN (SELECT * FROM CP_SOLICITACAOHISTORICO WHERE DESCRICAO = 'Aguardando aprovação') SOL_HIST ON SOL_HIST.SOLICITACAO = A.HANDLE
LEFT JOIN Z_GRUPOUSUARIOS SOL_APROVA ON SOL_APROVA.HANDLE=SOL_HIST.USUARIO
LEFT JOIN CP_ORDENSCOMPRA OCS ON OCS.NUMERODOCUMENTOORIGEM = A.NUMERO
WHERE A.NUMERO IN ("355991","354798","355684","354072","355640","354635","355829","354041","354053","354015","354646","356016","355045","354993","354070","356197","354054","353982","356191","354744","355054","355023","354791","355797","355805","353969","354869","355467","356043","354974","355236","354867","354648","355724","354623","354668","354980","354868","355006","354775","355015","354701","355145","354838","355321","355353","356018","355332","355126","354638","355307","354771","356232","356183","354790","354550","355955","354825","355066","355084","355041","354591","354976","355583","354243","355007","355242","354877","355017","356225","355186","355063","354461","355125","354759","354977","355040","356154","355071","355173","354893","354655","354566","354899","354873","354805","354558","355168","355827","355102","355076","355228","355227","355072","356075","354569","354774","355178","354625","355478","354875","355983","354582","354692","354589","354560","354653","355096","355410","354631","354641","355221","354910","355090","354633","354772","354768","355080","356175","355326","344501","350416","350419","340066","344632","350422","350423","340219","344482","347876","347902","354368","340732","349924","354407","354253","347487","347591","354263","354294","349068","344786","354313","349772","349568","340900","353702","350225","349747","346214","353517","349071","353690","339550","349680","340238","353649","349797","340431","344565","350959","350484","339402","353791","344659","354538","344661","349901","340779","354287","354296","338743","353493","340384","344368","344357","349595","347560","344576","340866","353345","354382","353505","353508","339200","354235","344740","344750","344761","351130","340495","353733","351368","354735","355270","355019","353788","356342","344790","344780","351410","340990","347280","341104","341079","347129","347222","343545","355284","350359","346585","338735","341038","341076","346563","341098","340951","348549","348575","341031","341070","343556","341155","346728","355462","347373","347329","347491","355584","341729","353282","348606","350621","350607","350636","339727","339607","353018","348676","350662","345857","345423","340947","344858","354748","351659","353476","353577","354797","353487","354777","341049","345057","355544","341151","353338","341165","355291","355301","344975","341348","354750","354741","341282","355767","354998","339465","339360","352434","349857","349800","349734","352457","342376","342953","342502","342444","352089","352131","342544","347951","346611","351386","351069","351109","351080","352511","352500","351096","355005","341347","355202","348261","349033","355851","353922","349025","355053","355062","349339","349187","349210","349240","349265","349294","349313","349325","349386","349513","349521","349529","355870","354783","346162","366213","366381","356155","341594","352772","341412","341441","349864","349878","349872","355888","354799","354816","354835","353750","353775","354468","353383","353250","353455","353446","354786","354801","355153","339673","345926","345938","351647","355924","355919","351688","346610","353595","341552","353042","355200","339030","341742","341731","353292","338905","350647","356047","341706","355342","350586","356226","356229","350623","355107","348008","353688","348273","348283","349002","348996","349024","349014","355962","349082","349035","349092","349102","349110","349125","341646","341630","354959","349139","349158","346471","341497","351792","351817","341518","345441","345373","355065","341853","341559","353245","352941","352444","355148","341698","351852","351842","351875","352983","351941","341778","351926","353769","346059","346053","345980","347154","350271","352680","350284","352688","348847","348875","348829","348817","348909","348927","353564","354628","341884","354394","354384","353012","354831","341930","344972","345017","341772","341740","348626","348638","348651","341815","348663","353400","341845","348691","352664","350706","350726","350753","349412","350793","350836","354404","353673","353691","353029","353242","341860","354747","339606","341887","351184","348017","353370","348533","348556","354982","356033","355486","348698","354662","355008","353167","349622","349655","349672","339958","349702","350272","349729","341900","354618","354830","349751","349776","354738","342373","348418","348401","348450","348413","348391","353389","352051","348931","348949","341967","353314","355516","349012","350117","350352","341919","342004","349146","342043","349203","349591","356093","353441","354252","350301","350455","351504","351511","353596","355078","355138","355124","355108","354952","355245","355243","355235","346090","354929","354943","354948","356174","350937","351536","354802","339853","350941","356024","353420","347171","342107","342074","353109","353464","349796","353061","354810","353645","353573","353957","342130","342140","354822","352738","346404","353459","353516","353519","353502","353494","354086","354075","354870","354853","354861","343837","346543","342170","351060","355048","348013","348363","348208","348164","355262","342197","347518","347529","355024","353566","355013","355009","342445","351895","353293","353286","353283","353279","342846","342855","342792","350590","353043","352088","342247","352080","342887","345833","352158","339758","346012","346021","351986","351542","356290","353265","342577","348185","348195","355117","355085","348232","348212","348645","348658","347984","348031","348024","348052","348012","348102","352074","352058","341897","342697","353334","354811","353258","354605","339402","342775","342829","342850","353001","352970","353023","338649","352995","347370","347378","347334","347350","355012","347437","350104","354436","354445","347481","347542","347565","352961","344873","347810","347882","347935","342907","348961","348929","348837","345723","354412","339989","339974","339931","355899","352944","352930","347076","352922","348228","348301","352527","343014","344938","351763","353278","352879","352822","352763","353406","353395","353391","353381","353376","353378","353369","353482","353462","352412","352450","343113","352938","352781","352770","353791","352780","351309","349845","343067","343060","354804","354823","352374","352220","352361","352390","352735","352526","352510","352490","339968","352380","352330","355426","355416","352213","353266","353770","353300","354610","353737","348426","339838","339698","352458","352433","353601","344047","353327","352157","344057","352141","352127","352094","352109","352055","352075","351922","351900","352820","352835","350869","350932","343561","352043","352004","352016","352025","341991","341928","353740","343296","343294","343328","343306","343316","351990","351983","352985","351948","353549","343581","352992","353010","353059","353046","346556","343371","354685","346725","354592","346708","346744","353181","352951","351940","348958","343376","353009","352977","353014","353003","352991","352869","349064","349067","343044","343082","343129","343075","343099","343154","343337","343174","343135","350945","343350","351911","345182","351196","355207","351885","352396","351837","345274","351807","351761","351785","351737","355406","353699","354785","353632","353678","353643","353436","353609","353161","353149","342110","353138","352816","342070","342016","351489","353705","341880","354300","353336","341970","341896","341949","341922","341917","341959","351464","351459","351466","351452","351435","351444","350982","342329","351026","353428","354843","350878","351679","341144","356124","351201","341372","354317","340024","340013","339999","355844","351378","351529","351545","355905","351651","351661","356198","351371","344378","351660","342436","342982","342687","342927","355799","354833","353554","351641","352709","351601","351567","351550","351586","342498","355821","355811","346529","345188","355059","346833","346896","347660","347661","347663","347666","349935","349964","353076","353087","353672","355782","353308","355775","353534","339967","354922","351076","351102","353633","351156","351385","356023","351170","344449","344422","339972","353291","351354","344355","344350","343677","343667","355359","343623","343657","343310","343753","343374","343353","343114","343594","343818","346145","347402","351337","351307","351063","345177","345103","345090","351432","343731","353004","343394","343345","355882","355717","342997","344802","354844","343427","349107","345732","377785","354060","353240","353408","353388","353697","353693","353656","353647","353640","352506","353477","353466","354936","354930","354912","354906","353548","353546","353543","353541","353540","353518","353515","353512","353504","353500","353496","352474","352466","352464","352438","352422","352417","352383","352218","352188","348022","353478","351018","355176","346305","346035","346047","346288","346030","346317","346349","345977","346330","346023","346109","345964","347901","348157","354094","349288","351497","348365","353426","345631","353246","355083","351120","351104","351148","346489","347170","347117","352737","344522","345314","352496","353304","353474","349028","355834","350446","353150","342886","349234","349354","349300","349404","353311","353454","353442","353434","353416","355455","353486","353325","355440","353271","353261","355912","350867","353461","349383","349554","355250","352962","353305","353299","353263","352973","352953","352942","352067","355644","353778","339046","351793","351769","351830","352415","351781","353438","353545","353563","352034","352052","355258","349599","349104","349659","354687","354246","350922","350938","355854","354050","354159","354146","348307","353595","354225","353245","353970","353974","354026","355600","353963","353947","354111","354404","351530","351554","353909","353997","344019","352001","351163","351088","351740","351225","354024","354055","352738","354236","352754","354191","351372","353043","355876","351499","351506","354274","354333","354370","354373","354389","354400","354366","348828","348846","348859","348877","348891","348904","348915","348932","348941","348997","349223","354189","354501","350296","354285","353740","354046","354067","354087","355866","355857","354251","353138","353705","353336","354300","350578","355433","350671","353999","353978","353035","353051","353893","353916","353925","353938","353937","353985","353930","353943","353906","353917","353874","353915","353461","353875","353883","353892","353901","353913","353929","353951","353941","354227","352362","352226","355854","354159","355575","355614","355636","355672","355699","353595","354228","355693","355621","355641","355663","353317","355677","355604","355618","355639","355645","355654","355659","355664","355646","355722","355631","355661","355678","355708","355692","355711","353637","355651","355657","355662","355593","353974","355606","355617","355629","355642","355587","355607","355647","355658","354552","355669","355675","355701","355707","354279","355676","355687","355695","355567","355561","355581","355628","355635","355649","355655","353963","355679","353592","355697","355706","353947","355681","355691","355546","354002","354048","353898","353881","354276","354613","355547","353043","355576","355585","355562","355602","355615","355626","355638","354389","354400","355648","354314","354320","354327","354328","353266","355550","355935","354285","354251","355627","354023","355611","355608","355586","355571","354207","354361")
ORDER BY A.DATAINCLUSAO