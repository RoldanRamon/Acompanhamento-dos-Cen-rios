SELECT DISTINCT A.DATAINCLUSAO AS DATA_INCLUSAO_SOL_PAI,
EMP.NOME AS NOME_EMPRESA,
FIL.NOME AS NOME_FILIAL,

CASE WHEN A.STATUS = 1 THEN 'CADASTRADA' ELSE
   CASE WHEN A.STATUS = 2 THEN 'CONFIRMADA' ELSE
       CASE WHEN A.STATUS = 3 THEN 'EM ATENDIMENTO' ELSE
          CASE WHEN A.STATUS = 4 THEN 'ENCERRADA' ELSE
             CASE WHEN A.STATUS = 5 THEN 'RECUSADA' ELSE
                CASE WHEN A.STATUS = 6 THEN 'CANCELADA' ELSE 'ATENDIMENTO DIVERGENTE'
                END
             END
          END
       END
   END
END AS STATUS_SOL_PAI,

CASE WHEN SOL_ITENS.STATUS = 1 THEN 'CADASTRADA' ELSE
   CASE WHEN SOL_ITENS.STATUS = 2 THEN 'ATENDIMENTO DIVERGENTE' ELSE
       CASE WHEN SOL_ITENS.STATUS = 3 THEN 'EM ATENDIMENTO' ELSE
          CASE WHEN SOL_ITENS.STATUS = 4 THEN 'ENCERRADA' ELSE
             CASE WHEN SOL_ITENS.STATUS = 5 THEN 'CANCELADA'
             END
          END
       END
   END
END AS STATUS_SOL_FILHO,

CASE WHEN A.MODALIDADE = 'R' THEN 'REGULARIZAÇÃO' ELSE
    CASE WHEN A.MODALIDADE = 'C' THEN 'CATALOGO' ELSE 'NORMAL' END
END AS MODALIDADE,
A.NUMERO AS NUM_SOL_PAI,
SOL_ITENS.NUMERO AS NUM_SOL_FILHO,
OCS.NUMERO AS ORDEM_DE_COMPRA,
UPPER(SOL.APELIDO) AS NOME_DO_SOLICITANTE,
UPPER(SOL.EMAIL) AS EMAIL_DO_SOLICITANTE,

CASE WHEN UPPER(SOL_APROVA.APELIDO) IS NOT NULL THEN UPPER(SOL_APROVA.APELIDO) ELSE
UPPER(APR.APELIDO) END AS NOME_DO_APROVADOR,
CASE WHEN UPPER(SOL_APROVA.EMAIL) IS NOT NULL THEN UPPER(SOL_APROVA.EMAIL) ELSE
UPPER(APR.EMAIL) END AS EMAIL_DO_APROVADOR,

REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(A.MOTIVOSTATUS ,char(13),''),char(9),''),char(10),''),'/N','/ N'),'/R','/ R') AS MOTIVO_STATUS,

SOL_ITENS.QUANTIDADE AS QUANTIDADE_SOLICITADA,
SOL_ITENS.VALORESTIMADO AS VALOR_DO_ITEM,
RA.CODIGO AS CENTRO_DE_CUSTO,
CASE WHEN SOL_ITENS.PROJETO IS NULL THEN 'OPEX' ELSE
'CAPEX' END AS PROJETO,
CONCAT(FIN.ESTRUTURA," - ",FIN.CODIGO) AS FINALIDADE_ESTRUTURA,
FIN.DESCRICAO AS FINALIDADE_DESCRICAO,


REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(A.OBSERVACOES ,char(13),''),char(9),''),char(10),''),'/N','/ N'),'/R','/ R') AS TEXTO_OBSERVACOES,
REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(AC.NOME ,char(13),''),char(9),''),char(10),''),'/N','/ N'),'/R','/ R') AS NOME_ITEM,
EA.NOME AS UNIDADE_DE_MEDIDA

FROM CP_SOLICITACOES A
LEFT JOIN EMPRESAS EMP ON EMP.HANDLE = A.EMPRESA
LEFT JOIN FILIAIS FIL ON FIL.HANDLE = A.FILIAL
LEFT JOIN Z_GRUPOUSUARIOS SOL ON SOL.HANDLE = A.SOLICITANTE
LEFT JOIN Z_GRUPOUSUARIOS APR ON APR.HANDLE = A.USUARIOALTERACAO
LEFT JOIN CP_SOLICITACAOITENS SOL_ITENS ON SOL_ITENS.SOLICITACAO = A.HANDLE
LEFT JOIN PD_PRODUTOS AC ON AC.HANDLE = SOL_ITENS.PRODUTO
INNER JOIN CM_UNIDADESMEDIDA EA ON  EA.HANDLE = AC.UNIDADEMEDIDACOMPRAS
LEFT JOIN CP_FINALIDADES FIN ON FIN.HANDLE = SOL_ITENS.FINALIDADE
LEFT JOIN CT_CC RA ON RA.HANDLE = SOL_ITENS.CENTROCUSTO
LEFT JOIN (SELECT * FROM CP_SOLICITACAOHISTORICO WHERE DESCRICAO = 'Aguardando aprovação') SOL_HIST ON SOL_HIST.SOLICITACAO = A.HANDLE
LEFT JOIN Z_GRUPOUSUARIOS SOL_APROVA ON SOL_APROVA.HANDLE=SOL_HIST.USUARIO
LEFT JOIN CP_ORDENSCOMPRA OCS ON OCS.NUMERODOCUMENTOORIGEM = A.NUMERO
WHERE A.NUMERO IN ("354294","355353","354653","357126","357319","357272","354070","357267","354054","353982","355228","357255","357154","353969","356183","340219","354253","353690","340732","347487","354893","354899","344565","355332","347560","357118","357113","357110","355640","355797","356043","354382","355168","354873","354875","354910","355326","355410","354868","355006","354976","340866","355145","355126","354638","356232","355186","355173","355080","354869","354582","340384","353493","353505","353508","354798","354646","356197","356191","354805","355307","346214","356154","355478","356175","354635","354631","355684","354701","354977","350422","350423","350416","350419","340066","347591","353702","354569","355955","355991","356016","356018","355983","355076","355102","354744","354633","355724","355583","356075","349772","340238","349568","354974","355236","344368","344632","355242","354566","354774","354692","350959","349747","344659","344501","344482","354980","354550","355041","355827","349595","339550","349680","354775","354867","350484","355125","354287","354296","350225","353517","349797","355090","353791","339402","354560","354591","354589","349901","355066","355072","340779","344786","354668","354313","354641","355805","355023","357226","354759","355017","354072","354041","354053","354015","354648","339200","353649","355829","356225","355084","354771","354791","347876","347902","354558","349068","349071","354623","340431","353345","354877","354790","338743","349924","354235","344576","356611","354655","357104","357175","344357","355063","354407","355071","357169","357172","357156","344740","344750","344761","351130","340495","357185","351368","354735","356342","344790","344780","351410","357059","347280","341104","347129","343545","355284","346585","338735","341038","341076","356387","341098","340951","348549","341031","341070","343556","341155","355462","347329","347491","348606","350636","339727","339607","353018","345423","344858","354748","351659","353476","353577","354797","353487","341049","345057","355544","353338","341282","339465","339360","342953","352434","349857","349800","349734","352457","342502","342444","352089","352131","346611","355202","355851","355053","355062","349187","349265","349294","349313","349325","349386","349529","355870","346162","366213","366381","341594","349864","349878","349872","355153","339673","351647","351688","346610","353595","341552","353042","341742","341731","353292","341706","348008","353688","348273","348283","349002","348996","349024","349014","355962","349082","349035","349092","349102","349110","349125","341646","341630","354959","349139","349158","346471","351792","351817","341518","345441","341853","357190","353245","351875","341778","353769","346059","346053","345980","347154","350271","352680","350284","352688","348847","348875","348829","348817","348909","353564","354628","341884","354394","354384","353012","341930","341772","341740","348626","348638","348651","341815","348663","353400","341845","348691","350706","350726","350793","350836","354404","353673","353691","353242","341860","354747","339606","341887","351184","348017","353370","348533","348556","348698","354662","349702","350272","341900","354618","349751","349776","353389","352051","348931","348949","341967","353314","349012","350117","350352","341919","349146","349591","353441","354252","350455","351504","351511","354952","346090","354929","354943","354948","350937","351536","339853","353420","342107","342074","353464","349796","353061","353645","353573","353957","342140","352738","346404","353459","353516","353519","353502","353494","354086","354075","343837","346543","342170","355048","348013","348363","342197","347518","347529","355024","353566","355013","342445","351895","353293","353286","353283","353279","342846","342855","342792","350590","342247","352080","342887","345833","339758","346021","351986","351542","356290","353265","342577","355117","348232","348212","348645","347984","348031","348024","348052","348012","348102","352074","352058","353258","354605","342775","353001","352970","353023","338649","347370","347378","347334","347350","350104","354436","354445","347542","347565","352961","344873","347810","347882","347935","345723","339989","339974","339931","355899","352944","352930","352922","348228","352527","343014","344938","351763","353278","352822","352763","353406","353395","353391","353381","353376","353378","353369","352450","343113","352780","351309","349845","343067","343060","352526","352490","353266","348426","339838","353601","344047","352157","352141","352127","352109","352055","352075","352820","352835","350869","343561","352043","352004","352016","352025","341991","341928","353740","343296","343294","343328","343306","343316","351990","351983","352985","351948","353549","352992","353010","346556","346725","354592","346708","346744","352951","352869","343044","343082","343129","343075","343099","343154","343337","343174","343135","350945","351196","345274","353632","342110","353138","352816","353705","341880","342329","351529","351545","342436","342982","342687","342498","346833","346896","344449","355359","343114","347402","343394","342997","349107","345732","377785","354060","353240","353466","354936","354930","354912","353543","353515","353512","353496","352474","352422","348022","348157","351497","348365","347170","347117","357152","353304","349028","355834","342886","353325","350867","352962","352973","357279","357275","352067","339046","351793","351769","349599","349104","350922","350938","355854","354159","354146","357176","353595","354225","353245","353970","353974","355600","353963","353947","354111","354404","351530","351554","353909","344019","351163","351088","351740","352738","354236","352754","354191","353043","354333","349223","354189","354501","354285","353740","354046","354067","354087","355866","355857","354251","353138","353705","353336","354300","350578","355433","350671","353999","353978","353035","353051","353893","353916","353925","353938","353937","353985","353930","353943","353906","353917","353874","353915","353461","353875","353883","353892","353901","353913","353929","353951","353941","354227","352362","352226","355854","354159","355575","355614","355636","355672","355699","353595","354228","355693","355621","355641","355663","353317","355677","355604","355618","355639","355645","355654","355659","355664","355646","355722","355631","355661","355678","355708","355692","355711","353637","355651","355657","355662","355593","353974","355606","355617","355629","355642","355587","355607","355647","355658","354552","355669","355675","355701","355707","354279","355676","355687","355695","355567","355561","355581","355628","355635","355649","355655","353963","355679","353592","355697","355706","353947","355681","355691","355546","354002","354048","353898","353881","354276","354613","355547","353043","355576","355585","355562","355602","355615","355626","355638","354389","354400","355648","354314","354320","354327","354328","353266","355550","355935","354285","354251","355627","354023","355611","355608","355586","355571","354207","354361")
ORDER BY A.DATAINCLUSAO