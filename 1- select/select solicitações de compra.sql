SELECT DISTINCT A.DATAINCLUSAO AS DATA_INCLUSAO_SOL_PAI,
EMP.NOME AS NOME_EMPRESA,
FIL.NOME AS NOME_FILIAL,

CASE WHEN A.STATUS = 1 THEN 'CADASTRADA' ELSE
   CASE WHEN A.STATUS = 2 THEN 'CONFIRMADA' ELSE
       CASE WHEN A.STATUS = 3 THEN 'EM ATENDIMENTO' ELSE
          CASE WHEN A.STATUS = 4 THEN 'ENCERRADA' ELSE
             CASE WHEN A.STATUS = 5 THEN 'RECUSADA' ELSE
                CASE WHEN A.STATUS = 6 THEN 'CANCELADA' ELSE 'ATENDIMENTO DIVERGENTE'
                END
             END
          END
       END
   END
END AS STATUS_SOL_PAI,

CASE WHEN SOL_ITENS.STATUS = 1 THEN 'CADASTRADA' ELSE
   CASE WHEN SOL_ITENS.STATUS = 2 THEN 'ATENDIMENTO DIVERGENTE' ELSE
       CASE WHEN SOL_ITENS.STATUS = 3 THEN 'EM ATENDIMENTO' ELSE
          CASE WHEN SOL_ITENS.STATUS = 4 THEN 'ENCERRADA' ELSE
             CASE WHEN SOL_ITENS.STATUS = 5 THEN 'CANCELADA'
             END
          END
       END
   END
END AS STATUS_SOL_FILHO,

CASE WHEN A.MODALIDADE = 'R' THEN 'REGULARIZAÇÃO' ELSE
    CASE WHEN A.MODALIDADE = 'C' THEN 'CATALOGO' ELSE 'NORMAL' END
END AS MODALIDADE,
A.NUMERO AS NUM_SOL_PAI,
SOL_ITENS.NUMERO AS NUM_SOL_FILHO,
OCS.NUMERO AS ORDEM_DE_COMPRA,
UPPER(SOL.APELIDO) AS NOME_DO_SOLICITANTE,
UPPER(SOL.EMAIL) AS EMAIL_DO_SOLICITANTE,

CASE WHEN UPPER(SOL_APROVA.APELIDO) IS NOT NULL THEN UPPER(SOL_APROVA.APELIDO) ELSE
UPPER(APR.APELIDO) END AS NOME_DO_APROVADOR,
CASE WHEN UPPER(SOL_APROVA.EMAIL) IS NOT NULL THEN UPPER(SOL_APROVA.EMAIL) ELSE
UPPER(APR.EMAIL) END AS EMAIL_DO_APROVADOR,

REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(A.MOTIVOSTATUS ,char(13),''),char(9),''),char(10),''),'/N','/ N'),'/R','/ R') AS MOTIVO_STATUS,

SOL_ITENS.QUANTIDADE AS QUANTIDADE_SOLICITADA,
SOL_ITENS.VALORESTIMADO AS VALOR_DO_ITEM,
RA.CODIGO AS CENTRO_DE_CUSTO,
CASE WHEN SOL_ITENS.PROJETO IS NULL THEN 'OPEX' ELSE
'CAPEX' END AS PROJETO,
CONCAT(FIN.ESTRUTURA," - ",FIN.CODIGO) AS FINALIDADE_ESTRUTURA,
FIN.DESCRICAO AS FINALIDADE_DESCRICAO,


REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(A.OBSERVACOES ,char(13),''),char(9),''),char(10),''),'/N','/ N'),'/R','/ R') AS TEXTO_OBSERVACOES,
REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(AC.NOME ,char(13),''),char(9),''),char(10),''),'/N','/ N'),'/R','/ R') AS NOME_ITEM,
EA.NOME AS UNIDADE_DE_MEDIDA

FROM CP_SOLICITACOES A
LEFT JOIN EMPRESAS EMP ON EMP.HANDLE = A.EMPRESA
LEFT JOIN FILIAIS FIL ON FIL.HANDLE = A.FILIAL
LEFT JOIN Z_GRUPOUSUARIOS SOL ON SOL.HANDLE = A.SOLICITANTE
LEFT JOIN Z_GRUPOUSUARIOS APR ON APR.HANDLE = A.USUARIOALTERACAO
LEFT JOIN CP_SOLICITACAOITENS SOL_ITENS ON SOL_ITENS.SOLICITACAO = A.HANDLE
LEFT JOIN PD_PRODUTOS AC ON AC.HANDLE = SOL_ITENS.PRODUTO
INNER JOIN CM_UNIDADESMEDIDA EA ON  EA.HANDLE = AC.UNIDADEMEDIDACOMPRAS
LEFT JOIN CP_FINALIDADES FIN ON FIN.HANDLE = SOL_ITENS.FINALIDADE
LEFT JOIN CT_CC RA ON RA.HANDLE = SOL_ITENS.CENTROCUSTO
LEFT JOIN (SELECT * FROM CP_SOLICITACAOHISTORICO WHERE DESCRICAO = 'Aguardando aprovação') SOL_HIST ON SOL_HIST.SOLICITACAO = A.HANDLE
LEFT JOIN Z_GRUPOUSUARIOS SOL_APROVA ON SOL_APROVA.HANDLE=SOL_HIST.USUARIO
LEFT JOIN CP_ORDENSCOMPRA OCS ON OCS.NUMERODOCUMENTOORIGEM = A.NUMERO
WHERE A.NUMERO IN ("355991","354798","355684","354072","355640","354635","355829","354041","354053","354015","354646","355045","354993","354070","354054","353982","354744","355054","355023","354791","355797","355805","353969","354869","355467","354974","355236","354867","354648","355724","354623","354668","354980","354868","355006","354775","355015","354701","355145","354838","355321","355353","355332","355126","354638","355307","354771","354790","354550","355955","354825","355066","355084","355041","354591","354976","355583","354243","355007","355242","354877","355017","355186","355063","354461","355125","354759","354977","355040","355071","355173","354893","354655","354566","354899","354873","354805","354558","355168","355827","355102","355076","355228","355227","355072","354569","354774","355178","354708","354625","355478","354875","355983","354582","354692","354589","354560","354653","355096","355410","354631","354641","355221","354910","355090","354633","354772","354768","355080","355326","344501","350416","350419","340066","344632","350422","350423","340219","344482","347876","347902","354368","340732","349924","354407","354253","347487","347591","354263","354294","349068","344786","353424","354313","349772","349568","340900","353702","350225","349747","346214","353517","349071","353690","339550","349680","340238","353649","349797","340431","344565","350959","350484","339402","353791","344659","354538","344661","349901","340779","354287","354296","338743","353493","340384","344368","344357","349595","347560","344576","340866","353345","354382","353505","353508","339200","354235","352737","345732","352638","353688","355544","353769","344790","344780","354952","353549","351895","355176","351464","348261","353181","354246","353778","341049","352763","348232","353304","351793","346556","353242","377785","343371","351769","355882","353474","341412","344858","351536","351792","351076","351817","351497","355117","353150","347373","348212","353245","346725","354592","352835","342445","343818","344740","346728","341031","353004","341884","339838","343044","350104","350446","339698","341070","341348","348228","351459","355245","354394","352450","347154","349622","353029","351830","355085","349125","339989","348273","343394","348283","349110","351018","351432","355019","348013","342982","344972","353076","350117","344750","347129","353266","355078","354685","343427","339974","351837","355767","354605","352415","348031","347984","341441","341928","351922","343837","348575","347481","355870","355888","341991","347518","349067","347370","339931","352985","353278","345423","354799","351184","347378","354929","353645","347437","346585","351371","347334","348606","343677","349529","344057","348931","348651","354816","354823","351900","351120","346305","351368","346035","352944","346708","354835","348024","347661","351781","351104","352962","343667","354750","349599","342953","353672","351763","338735","346047","346288","345723","351660","350869","355717","340990","353321","349107","342498","339046","355962","353246","351761","340024","349028","352951","353678","350945","354948","349313","354687","342886","353258","355083","353740","353305","353299","353263","352973","355359","351990","343623","353265","349033","355782","349024","351354","355851","353282","351466","341038","351102","345090","351130","352992","352664","351852","355243","355235","349288","346471","346404","348637","339465","346030","352879","348017","340013","351688","353699","349240","346317","353169","351785","343345","353519","353922","339030","345441","339958","345057","353087","347901","345017","353311","341742","341731","352458","355462","341698","352043","350271","353138","346012","352816","352822","348102","352074","352680","350284","353377","353705","342016","342850","344761","343657","349655","354741","355426","343296","353770","339999","366381","354810","352709","355270","355258","343350","352158","342829","342687","354404","343310","353673","349158","352004","348645","349513","349383","344422","351842","354783","342373","348426","349012","355905","353691","347350","353300","354610","353018","352738","345103","355048","345314","350932","351679","349702","353502","353494","349864","343014","341887","351060","355053","352526","352127","349935","346145","351885","346610","351983","352444","355065","352109","350836","352157","349064","341880","341076","342140","341372","349751","355024","345926","344355","344350","352396","352080","355107","345274","349014","342907","353043","348676","353334","352510","353308","354384","349102","351452","355207","347280","354060","341497","347402","349082","352433","353632","351807","354662","351489","351148","354804","347810","353338","351875","340947","353292","351586","339972","348847","339673","338905","349146","355406","355148","349591","340495","355138","342130","353737","347565","341772","350647","352412","341144","349354","353061","349776","355899","342887","352034","347882","348549","353001","348958","353595","349035","343113","351069","343545","339968","348961","343753","353750","351156","354998","352380","353596","352781","342697","351109","351080","351911","342927","348927","344802","353775","341155","352496","352374","343374","341919","346744","343731","347491","341930","341729","352995","342107","355416","351435","341815","342577","352511","352500","353566","349325","346833","349025","353420","349265","352941","342170","349845","348875","344522","341967","354300","350878","348663","341594","343294","349104","347935","348418","353314","351542","341646","346611","355153","347171","349659","350662","342436","352016","353336","343561","349139","344975","343082","343353","352025","355062","343328","350590","349002","347529","354468","348996","354412","354982","350636","349294","348829","348817","354890","354742","353010","355291","342502","344449","343129","339758","350301","348533","353733","341706","353406","353395","353391","353381","353376","350352","352051","353109","351601","353009","348556","342004","352330","354830","353378","353369","343376","351948","349339","341630","355486","353167","348301","343114","355143","351096","355250","352220","348698","342043","347542","348626","345857","346529","342544","352058","345373","355799","355284","353240","352977","355059","353014","355200","342997","355124","346090","339402","342070","353161","354831","341778","353383","353250","353791","347663","341151","355775","351337","341347","348949","349554","351170","351444","351647","349092","351386","354436","347951","353643","352457","355821","353400","353454","353442","353434","353416","345938","352052","351529","348658","343594","353482","353462","354843","355924","355919","355455","354959","351307","352983","349300","350941","351737","351940","353436","346021","353534","352970","341860","343075","339727","339607","352930","353408","353388","342376","347666","339360","353426","341970","355844","345188","353003","352780","347076","349234","343581","352772","351545","355342","346489","349210","350586","354992","355005","353455","353446","350982","353438","353428","352094","352088","354844","342444","348185","352922","348929","353441","345177","348363","355811","342074","354833","354822","353149","347660","350956","350937","350455","349796","343067","353573","350621","350607","343306","341845","353633","341104","354943","351063","355644","353697","353693","353656","353647","353640","352506","355912","350867","353461","349672","348365","354252","346563","348837","353023","354317","355301","349203","349404","352961","349521","342110","341897","353389","344873","343060","341552","352490","354786","351385","349412","354735","353042","352055","353477","353466","354801","341165","352089","341518","351378","347329","341098","346349","345977","353486","354870","354445","352131","353957","348638","345631","341740","354748","354086","354075","351410","350971","344938","348401","353325","339853","343316","353370","355008","352361","349729","341896","343099","353459","348052","351309","348450","348413","354811","344378","342846","352770","353012","353609","355000","351986","348909","352075","355440","351641","350706","351941","352213","353601","344047","354747","339606","350550","345833","349187","352141","353563","349964","343154","353293","353286","353283","353279","348157","348208","348164","355262","353059","352390","346330","346023","341282","341949","346059","346053","345980","346543","341853","347222","353271","353261","341922","342855","355013","349878","343337","352938","341559","354936","354930","354917","354912","354906","353548","353546","353543","353541","353540","353518","353515","353512","353504","353500","353496","353105","352474","352466","352464","352438","352422","352417","352383","352218","352188","348022","353487","340951","355516","346162","342329","355584","353545","350272","338649","353478","348008","341917","347170","348391","339967","350726","348195","351659","353327","354094","351026","353564","351567","351550","349386","351504","350753","351926","352434","349857","349800","349734","352991","350359","341079","352688","348691","341959","353788","355202","354738","346896","351201","343174","353577","354797","354802","352735","351511","354618","342247","346109","345964","354628","342197","350623","347117","355012","353464","342792","352820","355834","355009","354777","343556","343135","355108","352869","352953","352942","352067","351651","351661","353046","353291","351196","342775","353476","354853","345182","354861","354785","351683","353554","354922","349872","352527","348012","366213","350793","350922","350938","350955","350969","351033","355854","351046","354462","354050","354159","354146","354273","354187","354196","348307","354084","354134","354168","354122","354068","347515","353595","354225","353245","347704","353489","353970","353582","353637","353974","354026","353675","354552","354279","353932","353468","354249","354537","354244","355600","353511","353963","354214","354230","353907","353947","354111","354133","354157","354107","354124","354404","354045","354062","354079","354002","354020","354035","354073","354081","354061","354048","351530","351554","353873","353890","353899","351832","353909","353933","353948","353964","353997","344019","351921","353898","353881","353967","354276","352001","351163","351088","351106","351125","351193","351740","351225","354613","353987","354004","354024","354055","352738","354236","352754","354044","354112","354142","354167","354181","354193","354206","354213","354217","354232","354190","354199","354212","354224","354233","354240","354143","354162","354185","354191","348467","354402","347590","348293","348503","348540","347553","348547","348574","348583","348388","348371","347597","347600","347570","348309","348633","348347","348329","348655","348668","348567","351372","353043","355876","351400","351431","351442","351492","351499","351506","354274","354353","354355","354359","354333","354370","354373","354389","354400","354366","348828","348846","348859","348877","348891","348904","348915","348920","348932","348941","348997","349004","349011","349015","349021","349077","349096","349109","349223","349405","349408","349415","354301","354305","354309","354314","354320","354322","354327","354328","354148","354175","354189","354200","354216","349341","354501","353984","354351","354336","353266","354114","354123","354139","354156","350296","350288","351787","354016","351806","351846","353879","354025","351876","353894","353911","353918","353944","353902","351838","351861","351889","353952","354033","354039","353888","353924","353876","351820","353935","353975","351795","353993","353962","353971","353992","354031","354043","354059","354077","354093","354108","354285","353740","354046","354067","354087","355866","355857","353085","353112","354251","353138","353705","353336","354300","350578","355433","350671","353170","353999","353978","353035","353051","354023","353893","353916","353925","353938","353937","353985","353930","353943","352071","352811","353906","353917","353882","353896","353874","353915","353461","353875","353883","353892","353901","353913","353929","353951","353941","354186","354227","354209","354207","354361","354283","352362","352226","353251")
ORDER BY A.DATAINCLUSAO